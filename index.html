<!doctype html>
<html lang="en">
<head>
	<meta charset="UTF-8" />
	<title>Da Casino</title>
	<script type="text/javascript" src="js/phaser.js"></script>
	<script type="text/javascript" src="js/Card.js"></script>
	<script type="text/javascript" src="js/Deck.js"></script>
	<script type="text/javascript" src="js/Poker.js"></script>
	<script type="text/javascript" src="js/Paigow.js"></script>
	<script type="text/javascript" src="js/Hand.js"></script>
	

	<style type="text/css">
		body {
			margin: 0;
			background-color: grey;
		}
		input {
			text-align: center;
			width: 50px;
		}
	</style>
</head>

<body>

<script>

	var game = new Phaser.Game(1700,1500,Phaser.CANVAS, 'gamebox', { preload: preload, create: create, update: update, render: render }, true);

	// object containing cards
	var deck;

	function preload() {
		game.load.atlas('cards', 'assets/full-deck-with-joker.png','assets/full-deck-with-joker.json');
	}

	function create() {
		// create a shuffled deck for use in our game
		deck = Deck.create('standard',true,1);
//		console.log('created deck:',deck);
		
		var group = game.add.group();
		/*
		// show the deck
		for (var i=0;i<deck.length;i++) {
			var card = Card.create({card:deck[i]});
			group.addChild(card);
			card.x = 5+i*25;
		}
		*/

		// create some hands
		for (var n=0;n<7;n++) {
//			var set = ["joker_one", "king_diamond", "queen_diamond", "jack_diamond", "seven_spade", "seven_heart", "two_diamond" ];
//			var hand = Hand.create(set);
			// create a specific type of hand
			var hand = Hand.create(Poker.create('flush',50));

			// random hand from deck
//			var hand = Hand.create(deck.splice(0,7));

			// solve for poker
			hand.poker = Poker.solve(hand.sorted);
			// solve for pai-gow
			hand.paigow = Paigow.solve(hand.poker);
			// loop and display the hands
			for (var i=0;i<hand.original.length;i++) {
				var sorted = hand.sorted;
				var card = Card.create({card:sorted[i],clickable:true});
				if (card) {
					card.x = 5+i*135;
					card.y = 5+(200*n);
				}
			}
			// add some information for debugging yeah baby!
			var style = { font: '11pt Courier', fill: 'white', align: 'left', wordWrap: true, wordWrapWidth: 650 };
			var str = hand.poker.debug+'\n'+hand.paigow.debug;
			var text = game.add.text(950, 5+(200*n), str, style);			
		}

/*		
		// match the hand to an exist card on the screen so we can move it (do this instead of creating a new one each time)
		var num = 0;
		group.forEach(function(card) {
			if (hand.indexOf(card.key) != -1) {
				card.x = 5+135*num;
				card.y = 200;
				num++;
			}
		},this);
*/
	}

	function update() {

	}

	function render() {

	}
</script>
</body>
</html>
